{"ast":null,"code":"var _jsxFileName = \"D:\\\\dev\\\\cardclan-backend\\\\template-tool\\\\src\\\\components\\\\DesignTool\\\\index.tsx\";\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useState } from 'react';\nimport { INITIAL_STATE, TemplateContext } from '../../contexts/TemplateContext';\nimport SelectVariation from \"../tailwindComponents/SelectVariation\";\nimport SaveVariation from \"../tailwindComponents/SaveVariation\";\nimport swal from \"sweetalert\";\nimport SideBar from './SideBar';\nimport WebFont from \"webfontloader\";\nimport TopToolBar from './TopToolBar';\nimport MainStage from './MainStage';\nimport EditingTools from './EditingTools';\n\nconst DesignTool = () => {\n  const {\n    0: variationIndex,\n    1: setVariationIndex\n  } = useState(0);\n  const {\n    0: showSaveVariationModal,\n    1: setShowSaveVariationModal\n  } = useState(false);\n  const {\n    0: templateData,\n    1: setTemplateData,\n    2: {\n      goForward,\n      goBack,\n      stepNum,\n      history\n    }\n  } = useContext(TemplateContext);\n  const {\n    0: selectedId,\n    1: setSelectedId\n  } = useState(null);\n  const {\n    0: isOpenColorPicker,\n    1: setIsOpenColorPicker\n  } = useState(false);\n  const {\n    0: isEditTextBox,\n    1: setIsEditTextBox\n  } = useState(false);\n  useEffect(() => {\n    setIsOpenColorPicker(false);\n    setIsEditTextBox(false);\n  }, [selectedId]);\n\n  const unSelectAll = () => {\n    setIsOpenColorPicker(false);\n    setIsEditTextBox(false);\n    setSelectedId(null);\n  };\n\n  const handleEscape = e => {\n    if (e.key === \"Escape\") {\n      unSelectAll();\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener(\"keydown\", handleEscape, false);\n    WebFont.load({\n      google: {\n        families: ['Comfortaa', 'Josefin Sans', 'Euphoria Script', 'Oswald', 'Alfa Slab One', 'Bangers', 'Caveat', 'DM Sans', 'East Sea Dokdo', 'Homemade Apple', 'Kristi', 'Lobster Two', 'Maven Pro', 'Monoton', 'Montserrat', 'Playfair Display', 'Press Start 2P', 'Raleway', 'Roboto Slab', 'Shadows Into Light', 'Swanky and Moo Moo']\n      }\n    });\n    return () => {\n      document.removeEventListener(\"keydown\", handleEscape, false);\n    };\n  }, []);\n\n  const onUndo = () => {\n    !!setSelectedId && unSelectAll();\n\n    if (stepNum > 0) {\n      if (history[stepNum].variations.length > history[stepNum - 1].variations.length) {\n        setVariationIndex(variationIndex - 1);\n      }\n\n      goBack();\n    }\n  };\n\n  const onRedo = () => {\n    !!setSelectedId && unSelectAll();\n    stepNum < history.length - 1 && goForward();\n  };\n\n  const handleSaveVariation = variationData => {\n    setTemplateData(prev => {\n      prev.variations[variationIndex].name = variationData.name;\n      prev.variations[variationIndex].face = variationData.face;\n    });\n    setShowSaveVariationModal(false);\n  };\n\n  const handleAddVariation = () => {\n    if (templateData.variations.length < 3) {\n      setTemplateData(prev => {\n        prev.variations.push(templateData.variations[variationIndex]);\n      });\n      setVariationIndex(prev => prev + 1);\n    } else {\n      swal(\"Cannot create more than 3 variations!\");\n    }\n  };\n\n  const handleDeleteVariation = () => {\n    const variationsLength = templateData.variations.length;\n    swal({\n      title: \"Are you sure?\",\n      text: \"Do you want to delete this variation?\",\n      icon: \"warning\",\n      buttons: [\"Cancel\", \"Confirm\"],\n      dangerMode: true\n    }).then(willDelete => {\n      if (willDelete) {\n        if (variationsLength > 1) {\n          setTemplateData(prev => {\n            prev.variations.splice(variationIndex, 1);\n            if (variationIndex === variationsLength - 1) setVariationIndex(variationIndex - 1);\n          });\n        } else {\n          setTemplateData(INITIAL_STATE);\n        }\n      }\n    });\n  };\n\n  const handleEditSelectedItem = () => {\n    if (selectedId.split(\"_\")[0] === \"textBoxes\") {\n      setIsEditTextBox(true);\n      return;\n    }\n\n    setIsOpenColorPicker(true);\n  };\n\n  const handleDeleteSelectedItem = () => {\n    const type = selectedId.split(\"_\")[0];\n    setTemplateData(prev => {\n      prev.variations[variationIndex][type] = prev.variations[variationIndex][type].filter(item => item.id !== selectedId);\n      unSelectAll();\n    });\n  };\n\n  const handleCloseEditTextModal = () => {\n    setIsEditTextBox(false);\n  };\n\n  return __jsx(\"div\", {\n    className: \"min-w-max\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"h-20 mb-5 flex flex-wrap justify-center content-center bg-green-800\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    className: \"text-xl text-white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 17\n    }\n  }, \"Tempalte Design\")), showSaveVariationModal && __jsx(SaveVariation, {\n    templateData: templateData,\n    handleSaveVariation: handleSaveVariation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    className: \"grid grid-cols-3 gap-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, __jsx(SideBar, {\n    variationIndex: variationIndex,\n    setTemplateData: setTemplateData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 17\n    }\n  }, __jsx(TopToolBar, {\n    onUndo: onUndo,\n    onRedo: onRedo,\n    setTemplateData: setTemplateData,\n    variationIndex: variationIndex,\n    selectedId: selectedId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }), __jsx(\"div\", {\n    className: \"flex justify-center mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 21\n    }\n  }, __jsx(MainStage, {\n    templateData: templateData,\n    setTemplateData: setTemplateData,\n    variationIndex: variationIndex,\n    selectedId: selectedId,\n    setSelectedId: setSelectedId,\n    unSelectAll: unSelectAll,\n    handleEditSelectedItem: handleEditSelectedItem,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 25\n    }\n  })), __jsx(\"div\", {\n    className: \"flex justify-center mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  }, __jsx(SelectVariation, {\n    variations: templateData.variations,\n    variationIndex: variationIndex,\n    setVariationIndex: setVariationIndex,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 25\n    }\n  })), __jsx(\"div\", {\n    className: \"flex justify-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 21\n    }\n  }, __jsx(\"button\", {\n    className: \"inline-flex items-center h-8 px-4 m-2 text-sm text-green-100 transition-colors duration-150 bg-green-700 rounded-lg focus:shadow-outline hover:bg-green-800\",\n    onClick: () => setShowSaveVariationModal(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 25\n    }\n  }, \"Save Variation\"), __jsx(\"button\", {\n    className: \"inline-flex items-center h-8 px-4 m-2 text-sm text-green-100 transition-colors duration-150 bg-green-700 rounded-lg focus:shadow-outline hover:bg-green-800\",\n    onClick: handleAddVariation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 25\n    }\n  }, \"Add New Variation\"), __jsx(\"button\", {\n    className: \"inline-flex items-center h-8 px-4 m-2 text-sm text-green-100 transition-colors duration-150 bg-green-700 rounded-lg focus:shadow-outline hover:bg-green-800\",\n    onClick: handleDeleteVariation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 25\n    }\n  }, \"Delete variation\"))), __jsx(\"div\", {\n    className: selectedId ? \"\" : \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 17\n    }\n  }, __jsx(EditingTools, {\n    selectedId: selectedId,\n    unSelectAll: unSelectAll,\n    isOpenColorPicker: isOpenColorPicker,\n    isEditTextBox: isEditTextBox,\n    templateData: templateData,\n    setTemplateData: setTemplateData,\n    variationIndex: variationIndex,\n    handleEditSelectedItem: handleEditSelectedItem,\n    handleDeleteSelectedItem: handleDeleteSelectedItem,\n    handleCloseEditTextModal: handleCloseEditTextModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 21\n    }\n  }))));\n};\n\nexport default DesignTool;","map":{"version":3,"sources":["D:/dev/cardclan-backend/template-tool/src/components/DesignTool/index.tsx"],"names":["React","useContext","useEffect","useState","INITIAL_STATE","TemplateContext","SelectVariation","SaveVariation","swal","SideBar","WebFont","TopToolBar","MainStage","EditingTools","DesignTool","variationIndex","setVariationIndex","showSaveVariationModal","setShowSaveVariationModal","templateData","setTemplateData","goForward","goBack","stepNum","history","selectedId","setSelectedId","isOpenColorPicker","setIsOpenColorPicker","isEditTextBox","setIsEditTextBox","unSelectAll","handleEscape","e","key","document","addEventListener","load","google","families","removeEventListener","onUndo","variations","length","onRedo","handleSaveVariation","variationData","prev","name","face","handleAddVariation","push","handleDeleteVariation","variationsLength","title","text","icon","buttons","dangerMode","then","willDelete","splice","handleEditSelectedItem","split","handleDeleteSelectedItem","type","filter","item","id","handleCloseEditTextModal"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { INITIAL_STATE, TemplateContext } from '../../contexts/TemplateContext';\r\nimport SelectVariation from \"../tailwindComponents/SelectVariation\"\r\nimport SaveVariation from \"../tailwindComponents/SaveVariation\"\r\nimport swal from \"sweetalert\"\r\nimport SideBar from './SideBar';\r\nimport WebFont from \"webfontloader\";\r\nimport TopToolBar from './TopToolBar';\r\nimport MainStage from './MainStage';\r\nimport EditingTools from './EditingTools';\r\n\r\nconst DesignTool: React.FC = () => {\r\n\r\n    const [variationIndex, setVariationIndex] = useState<number>(0)\r\n\r\n    const [showSaveVariationModal, setShowSaveVariationModal] = useState(false)\r\n\r\n    const [templateData, setTemplateData, { goForward, goBack, stepNum, history }] = useContext(TemplateContext)\r\n    const [selectedId, setSelectedId] = useState<string | null>(null);\r\n    const [isOpenColorPicker, setIsOpenColorPicker] = useState<boolean>(false)\r\n    const [isEditTextBox, setIsEditTextBox] = useState(false)\r\n\r\n    useEffect(() => {\r\n        setIsOpenColorPicker(false)\r\n        setIsEditTextBox(false)\r\n    }, [selectedId])\r\n\r\n    const unSelectAll = () => {\r\n        setIsOpenColorPicker(false)\r\n        setIsEditTextBox(false)\r\n        setSelectedId(null)\r\n    }\r\n\r\n    const handleEscape = (e) => {\r\n        if (e.key === \"Escape\") {\r\n            unSelectAll()\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        document.addEventListener(\"keydown\", handleEscape, false);\r\n        WebFont.load({\r\n            google: {\r\n                families: ['Comfortaa', 'Josefin Sans', 'Euphoria Script', 'Oswald', 'Alfa Slab One', 'Bangers', 'Caveat', 'DM Sans', 'East Sea Dokdo', 'Homemade Apple', 'Kristi', 'Lobster Two', 'Maven Pro', 'Monoton', 'Montserrat', 'Playfair Display', 'Press Start 2P', 'Raleway', 'Roboto Slab', 'Shadows Into Light', 'Swanky and Moo Moo']\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            document.removeEventListener(\"keydown\", handleEscape, false);\r\n        };\r\n    }, []);\r\n\r\n    const onUndo = () => {\r\n        !!setSelectedId && unSelectAll();\r\n        if (stepNum > 0) {\r\n            if (history[stepNum].variations.length > history[stepNum - 1].variations.length) {\r\n                setVariationIndex(variationIndex - 1)\r\n            }\r\n            goBack();\r\n        }\r\n    };\r\n    const onRedo = () => {\r\n        !!setSelectedId && unSelectAll();\r\n        stepNum < (history.length - 1) && goForward();\r\n    };\r\n\r\n    const handleSaveVariation = (variationData: any) => {\r\n        setTemplateData(prev => {\r\n            prev.variations[variationIndex].name = variationData.name\r\n            prev.variations[variationIndex].face = variationData.face\r\n        })\r\n        setShowSaveVariationModal(false)\r\n    }\r\n\r\n    const handleAddVariation = () => {\r\n        if (templateData.variations.length < 3) {\r\n            setTemplateData(prev => {\r\n                prev.variations.push(templateData.variations[variationIndex])\r\n            })\r\n            setVariationIndex(prev => (prev + 1))\r\n        } else {\r\n            swal(\"Cannot create more than 3 variations!\")\r\n        }\r\n    }\r\n\r\n    const handleDeleteVariation = () => {\r\n        const variationsLength = templateData.variations.length\r\n        swal({\r\n            title: \"Are you sure?\",\r\n            text: \"Do you want to delete this variation?\",\r\n            icon: \"warning\",\r\n            buttons: [\"Cancel\", \"Confirm\"],\r\n            dangerMode: true,\r\n        }).then((willDelete) => {\r\n            if (willDelete) {\r\n                if (variationsLength > 1) {\r\n                    setTemplateData(prev => {\r\n                        prev.variations.splice(variationIndex, 1)\r\n                        if (variationIndex === (variationsLength - 1)) setVariationIndex(variationIndex - 1)\r\n                    })\r\n                } else {\r\n                    setTemplateData(INITIAL_STATE)\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    const handleEditSelectedItem = () => {\r\n        if (selectedId.split(\"_\")[0] === \"textBoxes\") {\r\n            setIsEditTextBox(true)\r\n            return\r\n        }\r\n        setIsOpenColorPicker(true)\r\n    }\r\n\r\n    const handleDeleteSelectedItem = () => {\r\n        const type = selectedId.split(\"_\")[0]\r\n        setTemplateData(prev => {\r\n            prev.variations[variationIndex][type] = prev.variations[variationIndex][type].filter(\r\n                item => item.id !== selectedId\r\n            )\r\n            unSelectAll()\r\n        })\r\n    }\r\n\r\n    const handleCloseEditTextModal = () => {\r\n        setIsEditTextBox(false)\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-w-max\">\r\n            <div className=\"h-20 mb-5 flex flex-wrap justify-center content-center bg-green-800\">\r\n                <p className=\"text-xl text-white\">Tempalte Design</p>\r\n            </div>\r\n\r\n            {showSaveVariationModal && (\r\n                <SaveVariation\r\n                    templateData={templateData}\r\n                    handleSaveVariation={handleSaveVariation}\r\n                />\r\n            )}\r\n\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n\r\n                {/* first col */}\r\n                <SideBar variationIndex={variationIndex} setTemplateData={setTemplateData} />\r\n\r\n                {/* Center column */}\r\n                <div>\r\n                    <TopToolBar\r\n                        onUndo={onUndo}\r\n                        onRedo={onRedo}\r\n                        setTemplateData={setTemplateData}\r\n                        variationIndex={variationIndex}\r\n                        selectedId={selectedId}\r\n                    />\r\n                    <div className=\"flex justify-center mt-5\">\r\n                        <MainStage\r\n                            templateData={templateData}\r\n                            setTemplateData={setTemplateData}\r\n                            variationIndex={variationIndex}\r\n                            selectedId={selectedId}\r\n                            setSelectedId={setSelectedId}\r\n                            unSelectAll={unSelectAll}\r\n                            handleEditSelectedItem={handleEditSelectedItem}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-center mt-5\">\r\n                        <SelectVariation\r\n                            variations={templateData.variations}\r\n                            variationIndex={variationIndex}\r\n                            setVariationIndex={setVariationIndex}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-center\">\r\n                        <button\r\n                            className=\"inline-flex items-center h-8 px-4 m-2 text-sm text-green-100 transition-colors duration-150 bg-green-700 rounded-lg focus:shadow-outline hover:bg-green-800\"\r\n                            onClick={() => setShowSaveVariationModal(true)}\r\n                        >Save Variation</button>\r\n                        <button\r\n                            className=\"inline-flex items-center h-8 px-4 m-2 text-sm text-green-100 transition-colors duration-150 bg-green-700 rounded-lg focus:shadow-outline hover:bg-green-800\"\r\n                            onClick={handleAddVariation}\r\n                        >Add New Variation</button>\r\n                        <button\r\n                            className=\"inline-flex items-center h-8 px-4 m-2 text-sm text-green-100 transition-colors duration-150 bg-green-700 rounded-lg focus:shadow-outline hover:bg-green-800\"\r\n                            onClick={handleDeleteVariation}\r\n                        >Delete variation</button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* third col */}\r\n                <div className={selectedId ? \"\" : \"hidden\"}>\r\n                    <EditingTools\r\n                        selectedId={selectedId}\r\n                        unSelectAll={unSelectAll}\r\n                        isOpenColorPicker={isOpenColorPicker}\r\n                        isEditTextBox={isEditTextBox}\r\n                        templateData={templateData}\r\n                        setTemplateData={setTemplateData}\r\n                        variationIndex={variationIndex}\r\n                        handleEditSelectedItem={handleEditSelectedItem}\r\n                        handleDeleteSelectedItem={handleDeleteSelectedItem}\r\n                        handleCloseEditTextModal={handleCloseEditTextModal}\r\n                    />\r\n                </div>\r\n\r\n            </div>\r\n\r\n\r\n        </div >\r\n    );\r\n};\r\nexport default DesignTool\r\n"]},"metadata":{},"sourceType":"module"}